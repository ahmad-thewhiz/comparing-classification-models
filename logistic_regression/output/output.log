nohup: ignoring input
Dataset directory: /home/dgxuser16/NTL/mccarthy/ahmad/Projects/ML_Course_Proj/data/twitter
Output directory: output/
Training Dataset has 1523665 rows and 2 columns
Testing Dataset has 359 rows and 2 columns
First 5 rows of the Training Dataset:
                                            sentence  sentiment
0  awww that s a bummer you shoulda got david car...          0
1  is upset that he can t update his facebook by ...          0
2  i dived many times for the ball managed to sav...          0
3     my whole body feels itchy and like its on fire          0
4  no it s not behaving at all i m mad why am i h...          0
Sentiment distribution in Training Set:
sentiment
0    766980
1    756685
Name: count, dtype: int64
First 5 rows of the Testing Dataset:
                                            sentence  sentiment
0  i loooooooovvvvvveee my kindle not that the dx...          1
1  reading my kindle love it lee childs is good read          1
2  ok first assesment of the kindle it fucking rocks          1
3  you ll love your kindle i ve had mine for a fe...          1
4  fair enough but i have the kindle and i think ...          1
Sentiment distribution in Testing Set:
sentiment
1    182
0    177
Name: count, dtype: int64
Time to transform training data: 26.17s
Training data shape: (1523665, 266876)
Time taken to extract features from test data: 0.01 seconds
Testing data shape: (359, 266876)
Starting RandomizedSearch...
Fitting 3 folds for each of 20 candidates, totalling 60 fits
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l2)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:1197: UserWarning: l1_ratio parameter is only used when penalty is 'elasticnet'. Got (penalty=l1)
  warnings.warn(
[CV] END l1_ratio=0.1, max_iter=200, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.9min
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.9min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l2, solver=liblinear, tol=0.0001; total time= 1.7min
[CV] END l1_ratio=0.9, max_iter=300, penalty=l1, solver=lbfgs, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=liblinear, tol=0.001; total time= 1.2min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l2, solver=liblinear, tol=0.0001; total time= 1.7min
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=liblinear, tol=0.001; total time= 1.2min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l2, solver=liblinear, tol=0.0001; total time= 1.5min
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.001; total time=   8.6s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.3s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.3s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.3s
[CV] END l1_ratio=0.9, max_iter=300, penalty=l1, solver=lbfgs, tol=0.001; total time=   0.3s
[CV] END l1_ratio=0.9, max_iter=300, penalty=l1, solver=lbfgs, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=liblinear, tol=0.001; total time= 1.3min
[CV] END l1_ratio=0.5, max_iter=300, penalty=l2, solver=saga, tol=0.0001; total time= 1.3min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l1, solver=saga, tol=0.001; total time=16.1min
[CV] END l1_ratio=0.5, max_iter=300, penalty=l2, solver=saga, tol=0.0001; total time= 1.4min
[CV] END l1_ratio=0.5, max_iter=300, penalty=elasticnet, solver=sag, tol=0.0001; total time=   0.5s
[CV] END l1_ratio=0.5, max_iter=300, penalty=elasticnet, solver=sag, tol=0.0001; total time=   0.3s
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.001; total time=  12.1s
[CV] END l1_ratio=0.1, max_iter=300, penalty=l1, solver=saga, tol=0.001; total time=16.2min
[CV] END l1_ratio=0.1, max_iter=200, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.4min
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=sag, tol=0.0001; total time=   0.5s
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=sag, tol=0.0001; total time=   0.3s
[CV] END l1_ratio=0.5, max_iter=300, penalty=l1, solver=sag, tol=0.0001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=300, penalty=elasticnet, solver=sag, tol=0.0001; total time=   0.5s
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.001; total time=   8.2s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.0001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.0001; total time=   0.4s
[CV] END l1_ratio=0.1, max_iter=300, penalty=l1, solver=saga, tol=0.001; total time=16.8min
[CV] END l1_ratio=0.5, max_iter=300, penalty=l2, solver=saga, tol=0.0001; total time= 1.3min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l1, solver=saga, tol=0.001; total time=17.1min
[CV] END l1_ratio=0.9, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.5s
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.5min
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=lbfgs, tol=0.0001; total time=   0.3s
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=lbfgs, tol=0.0001; total time=   0.4s
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=lbfgs, tol=0.0001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.0001; total time=   0.6s
[CV] END l1_ratio=0.1, max_iter=300, penalty=l1, solver=saga, tol=0.001; total time=18.4min
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=liblinear, tol=0.001; total time= 1.3min
[CV] END l1_ratio=0.5, max_iter=200, penalty=l1, solver=saga, tol=0.001; total time=18.9min
[CV] END l1_ratio=0.9, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.5s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=56.4min
[CV] END l1_ratio=0.1, max_iter=200, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.2min
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=58.5min
[CV] END l1_ratio=0.9, max_iter=200, penalty=elasticnet, solver=lbfgs, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=liblinear, tol=0.001; total time=   0.4s
[CV] END l1_ratio=0.5, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=63.1min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.001; total time=174.6min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.001; total time=182.8min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.001; total time=183.4min
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=liblinear, tol=0.001; total time= 1.3min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=200.4min
[CV] END l1_ratio=0.9, max_iter=300, penalty=l2, solver=lbfgs, tol=0.0001; total time= 1.3min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=213.5min
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py:540: FitFailedWarning: 
24 fits failed out of a total of 60.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
6 fits failed with the following error:
Traceback (most recent call last):
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1194, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 67, in _check_solver
    raise ValueError(
ValueError: Solver lbfgs supports only 'l2' or None penalties, got elasticnet penalty.

--------------------------------------------------------------------------------
6 fits failed with the following error:
Traceback (most recent call last):
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1194, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 75, in _check_solver
    raise ValueError(
ValueError: Only 'saga' solver supports elasticnet penalty, got solver=liblinear.

--------------------------------------------------------------------------------
3 fits failed with the following error:
Traceback (most recent call last):
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1194, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 67, in _check_solver
    raise ValueError(
ValueError: Solver sag supports only 'l2' or None penalties, got l1 penalty.

--------------------------------------------------------------------------------
3 fits failed with the following error:
Traceback (most recent call last):
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1194, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 67, in _check_solver
    raise ValueError(
ValueError: Solver sag supports only 'l2' or None penalties, got elasticnet penalty.

--------------------------------------------------------------------------------
6 fits failed with the following error:
Traceback (most recent call last):
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_validation.py", line 888, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 1194, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py", line 67, in _check_solver
    raise ValueError(
ValueError: Solver lbfgs supports only 'l2' or None penalties, got l1 penalty.

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/home/dgxuser16/anaconda3/envs/amd/lib/python3.11/site-packages/sklearn/model_selection/_search.py:1103: UserWarning: One or more of the test scores are non-finite: [       nan 0.78831449 0.78819575 0.78766199 0.78819771 0.78761399
 0.78761399        nan 0.7882133  0.78830061 0.78764726        nan
        nan 0.75699538        nan        nan 0.78764924        nan
        nan 0.78765932]
  warnings.warn(
[CV] END l1_ratio=0.9, max_iter=200, penalty=l1, solver=liblinear, tol=0.001; total time= 1.3min
[CV] END l1_ratio=0.1, max_iter=200, penalty=elasticnet, solver=saga, tol=0.0001; total time=233.1min
RandomizedSearch completed in 31743.22s
Best parameters found:
{'tol': 0.001, 'solver': 'saga', 'penalty': 'elasticnet', 'max_iter': 200, 'l1_ratio': 0.1}
Best cross-validation F1-weighted score:
0.7883
Prediction time: 0.0011s
Accuracy on test set: 81.62%
Classification report for the optimized classifier:

              precision    recall  f1-score   support

           0       0.83      0.79      0.81       177
           1       0.80      0.85      0.82       182

    accuracy                           0.82       359
   macro avg       0.82      0.82      0.82       359
weighted avg       0.82      0.82      0.82       359

Confusion matrix heatmap saved as 'output/confusion_matrix_heatmap.png'
Model saved as 'output/best_lr_classifier_model.pkl'
